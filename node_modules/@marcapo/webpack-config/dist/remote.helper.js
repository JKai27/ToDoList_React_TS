"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateRemoteConfig = void 0;
const semver_1 = require("semver");
const getCleanProjectName = (name) => name.replace("@marcapo/", "");
const getSuperCleanProjectName = (name) => name.replace("@marcapo/", "").replaceAll("-", "_");
const generateRemoteConfig = (remote) => {
    let versionString = remote;
    try {
        const packageLock = require("../../package-lock.json");
        const version = packageLock.version;
        console.log("package-lock-version: ", version);
        let requestedVersion = null;
        if (version === 3) {
            requestedVersion = packageLock.packages[`node_modules/${remote}`]?.version;
        }
        else if (version === 2) {
            requestedVersion = packageLock.dependencies[remote]?.version;
        }
        versionString = `/js/${getSuperCleanProjectName(remote)}/${(0, semver_1.major)(requestedVersion)}.${(0, semver_1.minor)(requestedVersion)}`;
    }
    catch (e) {
        console.error(e);
    }
    return {
        url: versionString,
        module: ".",
        scope: getCleanProjectName(remote),
    };
};
exports.generateRemoteConfig = generateRemoteConfig;
